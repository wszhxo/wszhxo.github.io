# CAS

多线程情况下当一个线程对一个变量(比如`i=1`)进行加1操作,首先会读取变量的值,加1后会判断i是否还是1没变,如果没变则会把i修改为2,如果i不为1说明已经被另外的线程修改过了(比如修改为了3),此时又会拿到3去加1,在返回判断i是否为3,是则替换为4,否则接着循环

![image-20200516132112510](C:\Users\25006\AppData\Roaming\Typora\typora-user-images\image-20200516132112510.png)

## ABA问题

如果说有三个线程,开始i=1,A线程修改i=2,B线程再次修改i=1,C线程过来发现i=1并没有变化,因此就可以进行上述加1的步骤,问题的关键就是C线程并不知道i其实已经改动过了,这就是问题所在

想要解决这个问题可以加入版本号,比如刚开始的i=1此时版本号为1.0,只要修改过这个版本号就要变化,以此解决ABA问题

